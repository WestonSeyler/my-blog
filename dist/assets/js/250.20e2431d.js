(window.webpackJsonp=window.webpackJsonp||[]).push([[250],{687:function(s,a,t){"use strict";t.r(a);var e=t(30),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("img",{attrs:{src:"https://pek3b.qingstor.com/hexo-blog/hexo-blog/20201118110408.png",alt:""}})]),s._v(" "),t("p",[s._v("虎符： 古代皇帝调兵遣将用的兵符，用青铜或者黄金做成伏虎形状的令牌，劈为两半，其中一半交给将帅，另一半由皇帝保存。只有两个虎符同时合并使用，持符者即获得调兵遣将权。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pek3b.qingstor.com/hexo-blog/hexo-blog/20201118110516.png",alt:""}})]),s._v(" "),t("p",[s._v("ssh key跟虎符类似")]),s._v(" "),t("p",[s._v("通过ssh-keygen命令生成公钥文件和私玥文件，私玥存本地，不告诉其他人。\n把公钥放到需要认证的服务器。然后通过ssh登录，会进行公私钥认证。匹配成功即实现无密码登录。\n同理把公钥放到如github，码云等提供git仓库的服务商。就能实现ssh协议非账号密码pull push代码。")]),s._v(" "),t("p",[s._v("机器A 向 机器B 进行免密码登陆")]),s._v(" "),t("h2",{attrs:{id:"流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#流程"}},[s._v("#")]),s._v(" 流程")]),s._v(" "),t("h3",{attrs:{id:"_1-生成公私钥对"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-生成公私钥对"}},[s._v("#")]),s._v(" 1. 生成公私钥对")]),s._v(" "),t("p",[s._v("机器A执行，修改邮箱\n"),t("code",[s._v('ssh-keygen -t rsa -b 4096 -C "finley@mymac.com"')])]),s._v(" "),t("p",[s._v("一般一路回车，默认会在当前用户目录创建.ssh目录并生成id_ras私钥和id_ras.pub公钥\n为了无密码登录服务器，需要将公钥上传到服务器的"),t("code",[s._v("authorized_keys")]),s._v("的文件中\n就是说我用ssh方式敲你的门，我提供私钥，你提供公钥，算法匹配成功，就让我进去。")]),s._v(" "),t("h3",{attrs:{id:"_2-添加公钥到机器b"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加公钥到机器b"}},[s._v("#")]),s._v(" 2. 添加公钥到机器B")]),s._v(" "),t("p",[s._v("不推荐手动拷贝，建议使用"),t("code",[s._v("ssh-copy-id")]),s._v("命令")]),s._v(" "),t("p",[s._v("如果对方机器SSH端口是22，不用特别指定")]),s._v(" "),t("p",[t("code",[s._v("ssh-copy-id -i ~/.ssh/id_rsa.pub 用户名@对方机器IP")])]),s._v(" "),t("p",[s._v("指定端口")]),s._v(" "),t("p",[t("code",[s._v("ssh-copy-id -i ~/.ssh/id_rsa.pub -p 5722 用户名@对方机器IP")])]),s._v(" "),t("p",[s._v("这个过程是将本地公钥加写到机器B的 ~/.ssh/authorized_keys 文件\n这次需要输入机器B的登录密码")]),s._v(" "),t("h3",{attrs:{id:"修改本地的-ssh-config添加连接配置项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改本地的-ssh-config添加连接配置项"}},[s._v("#")]),s._v(" 修改本地的"),t("code",[s._v("~/.ssh/config")]),s._v("添加连接配置项")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Host cloud my\n    HostName 140.xxx.xxx.183\n    User ubuntu\n    Port 22\n    IdentityFile ~/.ssh/id_rsa\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试"}},[s._v("#")]),s._v(" 测试")]),s._v(" "),t("p",[s._v("机器A执行"),t("code",[s._v("ssh cloud")]),s._v("或"),t("code",[s._v("ssh my")]),s._v("查看是否可以顺利登录")]),s._v(" "),t("h2",{attrs:{id:"排错"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#排错"}},[s._v("#")]),s._v(" 排错")]),s._v(" "),t("p",[s._v("1.公钥拷贝成功了，还让输入帐号密码")]),s._v(" "),t("p",[s._v("答：尝试设置文件权限")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("    //用户权限\n    chmod 700 /home/username\n\n    //.ssh文件夹权限\n    chmod 700 ~/.ssh/\n\n    // ~/.ssh/authorized_keys 文件权限\n    chmod 600 ~/.ssh/authorized_keys\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("2.检查ssh服务配置文件")]),s._v(" "),t("p",[s._v("vim /etc/ssh/sshd_config")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("// 这行可能被注释了，开启\nRSAAuthentication yes\nPubkeyAuthentication yes\n\n#禁用root账户登录，如果是用root用户登录请开启\nPermitRootLogin yes\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("重启服务"),t("code",[s._v("sudo systemctl restart sshd.service")])]),s._v(" "),t("p",[s._v("3.加 -v 参数，查看调试信息\nssh cloud -vvv")]),s._v(" "),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),t("p",[s._v("https://www.cnblogs.com/guanyf/p/10600458.html")])])}),[],!1,null,null,null);a.default=n.exports}}]);