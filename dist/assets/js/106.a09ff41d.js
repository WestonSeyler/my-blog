(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{544:function(s,e,n){"use strict";n.r(e);var a=n(30),r=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("Express号称web框架，我不以为然，我理解的框架应该包含很多东西，Express的核心思想是中间件。\n你需要什么功能搜相应的中间件就可以了。")]),s._v(" "),n("h3",{attrs:{id:"中间件的写法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#中间件的写法"}},[s._v("#")]),s._v(" 中间件的写法")]),s._v(" "),n("p",[s._v("支持 callback1,callback2、[callback1, callback2]、function callback(req, res, next) 或混合写法")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("function cb1(req, res, next) {\n  console.log('--cb1--');\n  next();\n}\n\nfunction cb2(req, res, next) {\n  console.log('--cb2--');\n  next();\n}\n\napp.get('/',\n  cb1, [cb2],\n  (req, res, next) => {\n    console.log('--cb3--');\n    next();\n  },\n  (req, res, next) => {\n  res.send('hello');\n});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("h3",{attrs:{id:"middleware之间传值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#middleware之间传值"}},[s._v("#")]),s._v(" middleware之间传值")]),s._v(" "),n("p",[s._v("使用 "),n("code",[s._v("res.locals.key=value;")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("app.use(function(req, res, next) {\n    res.locals.user = req.user;  \n    res.locals.authenticated = ! req.user.anonymous;\n    next();\n});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("传给下一个")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("app.use(function(req, res, next) {\n    if (res.locals.authenticated) {\n        console.log(res.locals.user.id);\n    }\n    next();\n});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("h3",{attrs:{id:"表单提交及json格式提交"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#表单提交及json格式提交"}},[s._v("#")]),s._v(" 表单提交及json格式提交")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("var express = require('express');\nvar app = express();\nvar bodyParser = require('body-parser');\n\n// 支持解析json格式\napp.use(bodyParser.json());\n\n// 支持解析 application/x-www-form-urlencoded 编码，就是表单提交\nvar urlencodedParser = bodyParser.urlencoded({ extended: false })\n\n// 这个urlencodedParser必须带，不然 request.body 为 undefined\napp.post('/', urlencodedParser, function(request, response) {\n    console.dir(request.body);\n      response.send('It works');\n    }\n});\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("不带 app.use(bodyParser.json()); 不支持下面的提交\n"),n("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-96e45d1ac26a9649.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}}),s._v("\n也就是\n"),n("code",[s._v("Content-Type: application/json")])])]),s._v(" "),n("li",[n("p",[s._v("带 var urlencodedParser = bodyParser.urlencoded({ extended: false })\n"),n("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-e26b7c5f791141fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})])])]),s._v(" "),n("p",[s._v("参考：\nhttp://expressjs.com/en/resources/middleware/body-parser.html")])])}),[],!1,null,null,null);e.default=r.exports}}]);