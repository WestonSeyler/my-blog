(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{573:function(s,t,a){"use strict";a.r(t);var n=a(30),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"playbook"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#playbook"}},[s._v("#")]),s._v(" playbook")]),s._v(" "),a("p",[s._v("使用 Ansible 时，绝大部分时间将花费在编写playbook上。playbook 英文直译是剧本的意思，是一个Ansible术语，它指的是用于配置管理的脚本。")]),s._v(" "),a("p",[s._v("playbook 是 YAML格式的，yaml格式可以很方便的被转换为json供开发语言使用")]),s._v(" "),a("p",[s._v("顺便推荐一个在线的 "),a("a",{attrs:{href:"http://nodeca.github.io/js-yaml/",target:"_blank",rel:"noopener noreferrer"}},[s._v("YAML转json服务"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("playbook是一个非常简单的配置管理和多主机部署系统，不同于任何已经存在的模式，可作为一个适合部署复杂应用程序的基础。playbook可以定制配置，可以按指定的操作步骤有序执行，支持同步及异步方式。")]),s._v(" "),a("p",[s._v("playbook是Ansible实现批量自动化最重要的手段。在其中可以使用变量、引用、循环等功能，功能比较强大。")]),s._v(" "),a("p",[s._v("一个playbook就是一组play组成的列表")]),s._v(" "),a("p",[s._v("每个play必须包含host和task，play就可以想象为连接到主机(host)上执行任务(task)的事物")]),s._v(" "),a("p",[s._v("host就是inventory中定义的主机")]),s._v(" "),a("p",[s._v("tasks下定义一系列的task任务列表，依次执行，如果执行某任务失败了，后续的任务不会执行")]),s._v(" "),a("blockquote",[a("p",[a("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-7deca4044e5f29db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})])]),s._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),a("p",[s._v("playbook.yml")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yaml文件可以以 --- 开头")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" the first demo  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 '-' 减号作为列表项，会被解析为json数组，注意在playbook中name属性不是必须的，表示描述，表示圈定一个范围，范围内的项都属于该列表。")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" cloud  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# cloud 是定义的主机，每一个playbook中必须包含"hosts"和"tasks"项')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" execute date cmd  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 描述这个task")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /bin/date "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 本质是加载并执行ansible对应的模块")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("转换为JSON")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[ { \n   name: 'the first demo',\n    hosts: 'cloud',\n    tasks: [ \n       { \n          name: 'execute date cmd', \n          command: '/bin/date' \n       } \n   ] \n} ]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("执行前先检查 "),a("code",[s._v("ansible-playbook playbook.yml --check")])]),s._v(" "),a("h3",{attrs:{id:"有用的flag"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#有用的flag"}},[s._v("#")]),s._v(" 有用的flag")]),s._v(" "),a("p",[s._v("--check 对支持check的大部分核心模块，输出真正执行会进行哪些更改\n--diff 报告更改，比如操作文件，会告诉用户之前之后发生了哪些变化，由于会产生大量输出，最好在单一主机使用")]),s._v(" "),a("p",[s._v("另外例子")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" localhost "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列表1")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remote_user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test1 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 子列表，下面是shell模块，是一个动作，所以定义为列表，只不过加了个name")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shell")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" echo /tmp/a.txt\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" hi_var\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" var=hi_var.stdout "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调用模块，这是动作，所以也是列表 # 同样是动作，包含文件")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("include")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /tmp/nginx.yml\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("include")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /tmp/mysql.yml\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("copy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 调用模块，定义为列表。但模块参数是虚拟性内容，应定义为字典而非列表 ")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("src")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /etc/resolv.conf  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 模块参数1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /tmp   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 模块参数2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 192.168.100.65  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列表2")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("remote_user")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("vars")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nginx_port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义变量，是虚拟性的内容，应定义为字典而非列表")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mysql_port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("vars_files")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" nginx_port.yml  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 无法写成key/value格式，且是实体文件，因此定义为列表")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test2\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shell")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" echo /tmp/a.txt\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" hi_var  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# register是和最近一个动作绑定的")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" var=hi_var.stdout\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("p",[s._v("通过 "),a("code",[s._v("ansible-playbook -h")]),s._v(" 获取所有参数列表\n首先"),a("code",[s._v("ansible-playbook -C playbook.yml")]),s._v("检查语法。这里我故意写错了，在 -name同级添加了 hosts，这是不允许的，所以报错了。Ansible 的错误提示还是很方便的。")]),s._v(" "),a("blockquote",[a("p",[a("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-e4945f8ff7acc851.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})])]),s._v(" "),a("p",[s._v("修改后：")]),s._v(" "),a("blockquote",[a("p",[a("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-dd163c683cf0e542.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})])]),s._v(" "),a("h3",{attrs:{id:"playbook中的配置项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#playbook中的配置项"}},[s._v("#")]),s._v(" playbook中的配置项")]),s._v(" "),a("p",[s._v("playbook 除了hosts和tasks还有其他配置项：")]),s._v(" "),a("ul",[a("li",[s._v("name   play的描述，Ansible执行时会打印出来")]),s._v(" "),a("li",[s._v("remote_user 指定在远程主机上执行任务的用户")]),s._v(" "),a("li",[s._v("vars")]),s._v(" "),a("li",[s._v("vars_files")])]),s._v(" "),a("p",[s._v("配置\nplaybook 例子，包含了1个play，3个tasks，1个handlers")]),s._v(" "),a("blockquote",[a("p",[a("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-8d5e07278c31d6c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})])]),s._v(" "),a("h3",{attrs:{id:"notify和handler"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#notify和handler"}},[s._v("#")]),s._v(" notify和handler")]),s._v(" "),a("p",[s._v("ansible中几乎所有的模块都具有幂等性，这意味着被控主机的状态是否发生改变是能被捕捉的，即每个任务的 changed=true或changed=false。ansible在捕捉到changed=true时，可以触发notify组件(如果定义了该组件)。\nnotify是一个组件，并非一个模块，它可以直接定义action，其主要目的是调用handler。例如:")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("tasks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" copy template file to remote host\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("template")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" src=/etc/ansible/nginx.conf.j2 dest=/etc/nginx/nginx.conf\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("notify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" restart nginx\n         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" test web page\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("copy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" src=nginx/index.html.j2 dest=/usr/share/nginx/html/index.html\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("notify")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" restart nginx\n "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("handlers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" restart nginx\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" name=nginx state=restarted\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test web page\n       "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("shell")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" curl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("I http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//192.168.100.10/index.html "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" grep 200 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" /bin/false\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("p",[s._v("这表示当执行template模块的任务时，如果捕捉到changed=true，那么就会触发notify，如果分发的index.html改 变了，那么也重启nginx(当然这是没必要的)。notify下定义了两个待调用的handler。handler主要用于重启服务或者触发系统重启，除此之外很少使用handler。")]),s._v(" "),a("p",[s._v("handler的定义和tasks的定义完全一样，唯一需要限定的是handler中task的name必须和notify中定义的名称相同。")]),s._v(" "),a("blockquote",[a("p",[s._v("注意，notify是在执行完一个play中所有task后被触发的，在一个play中也只会被触发一次。")])]),s._v(" "),a("p",[s._v("意味着如果一个play中有多个task出现了changed=true，它也只会触发一次。例如上面的示例中，向nginx复制配置文件和复制\nindex.html时如果都发生了改变，都会触发重启nginx操作。但是只会在执行完play后重启一次，以避免多余的重启。")])])}),[],!1,null,null,null);t.default=e.exports}}]);