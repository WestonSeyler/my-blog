(window.webpackJsonp=window.webpackJsonp||[]).push([[370],{807:function(s,a,r){"use strict";r.r(a);var e=r(30),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,r=s._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[r("p",[s._v("原文：\nhttps://rxjs-dev.firebaseapp.com/guide/v6/migration\n转载地址：\nhttps://segmentfault.com/a/1190000014956260\n节选")]),s._v(" "),r("h3",{attrs:{id:"修改import路径"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#修改import路径"}},[s._v("#")]),s._v(" 修改import路径")]),s._v(" "),r("p",[s._v("建议TypeScript开发人员使用rxjs-tslint来重构import路径。\nRxJS团队设计了以下规则来帮助JavaScript开发人员重构import路径：")]),s._v(" "),r("ul",[r("li",[s._v("rxjs: 包含创建方法，类型，调度程序和工具库。")])]),s._v(" "),r("p",[s._v("import { Observable, Subject, asapScheduler, pipe, of, from, interval, merge, fromEvent } from 'rxjs';")]),s._v(" "),r("ul",[r("li",[s._v("rxjs/operators: 包含所有的管道操作符")])]),s._v(" "),r("p",[s._v("import { map, filter, scan } from 'rxjs/operators';")]),s._v(" "),r("ul",[r("li",[s._v("rxjs/webSocket: 包含websocket subject实现.")])]),s._v(" "),r("p",[s._v("import { webSocket } from 'rxjs/webSocket';")]),s._v(" "),r("ul",[r("li",[s._v("rxjs/ajax: 包含Rx ajax实现.")])]),s._v(" "),r("p",[s._v("import { ajax } from 'rxjs/ajax';")]),s._v(" "),r("ul",[r("li",[s._v("rxjs/testing: 包含RxJS的测试工具库.")])]),s._v(" "),r("p",[s._v("import { TestScheduler } from 'rxjs/testing';")]),s._v(" "),r("h3",{attrs:{id:"使用管道操作而不是链式操作"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用管道操作而不是链式操作"}},[s._v("#")]),s._v(" 使用管道操作而不是链式操作")]),s._v(" "),r("p",[s._v("请按照如下步骤将您的链式操作替换为管道操作：")]),s._v(" "),r("ul",[r("li",[s._v("从rxjs-operators中引入您需要的操作符")])]),s._v(" "),r("blockquote",[r("p",[s._v("注意：由于与Javascript保留字冲突，以下运算符名字做了修改：do -> tap, catch ->\ncatchError, switch -> switchAll, finally -> finalize")])]),s._v(" "),r("p",[s._v("import { map, filter, catchError, mergeMap } from 'rxjs/operators';")]),s._v(" "),r("ul",[r("li",[r("strong",[s._v("使用pipe()包裹所有的操作符方法")]),s._v("。确保所有操作符间的.被移除，转而使用,连接。\n记住！！！有些操作符的名称变了！！！\n以下为升级示例：")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("// Rxjs5写法，操作符链\nsource\n  .map(x => x + x)\n  .mergeMap(n => of(n + 1, n + 2)\n    .filter(x => x % 1 == 0)\n    .scan((acc, x) => acc + x, 0)\n  )\n  .catch(err => of('error found'))\n  .subscribe(printResult);\n\n// Rxjs写法，需要用pipe包一下所有的操作符\n\nsource.pipe(\n  map(x => x + x),\n  mergeMap(n => of(n + 1, n + 2).pipe(\n    filter(x => x % 1 == 0),\n    scan((acc, x) => acc + x, 0),\n  )),\n  catchError(err => of('error found')),\n).subscribe(printResult);\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br"),r("span",{staticClass:"line-number"},[s._v("15")]),r("br"),r("span",{staticClass:"line-number"},[s._v("16")]),r("br"),r("span",{staticClass:"line-number"},[s._v("17")]),r("br"),r("span",{staticClass:"line-number"},[s._v("18")]),r("br"),r("span",{staticClass:"line-number"},[s._v("19")]),r("br"),r("span",{staticClass:"line-number"},[s._v("20")]),r("br")])]),r("p",[s._v("注意我们在以上代码中嵌套使用了pipe()。\nBen Lesh在"),r("a",{attrs:{href:"https://www.ng-conf.org/sessions/introducing-rxjs6/",target:"_blank",rel:"noopener noreferrer"}},[s._v("ng-conf 2018"),r("OutboundLink")],1),s._v("上解释了"),r("a",{attrs:{href:"https://youtu.be/JCXZhe6KsxQ?t=2m30s",target:"_blank",rel:"noopener noreferrer"}},[s._v("为什么我们应该使用管道操作符"),r("OutboundLink")],1),s._v("。")]),s._v(" "),r("h3",{attrs:{id:"其他rxjs6弃用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#其他rxjs6弃用"}},[s._v("#")]),s._v(" 其他RxJs6弃用")]),s._v(" "),r("p",[s._v("Observable.if and Observable.throw\nObservable.if已被iif()取代，Observable.throw已被throwError()取代。您可使用rxjs-tslint将这些废弃的成员方法修改为函数调用。")]),s._v(" "),r("p",[s._v("代码示例如下：")]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("OBSERVABLE.IF > IIF()\n// deprecated\nObservable.if(test, a$, b$);\n\n// use instead\n\niif(test, a$, b$);\nOBSERVABLE.ERROR > THROWERROR()\n// deprecated\nObservable.throw(new Error());\n\n//use instead\n\nthrowError(new Error());\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br"),r("span",{staticClass:"line-number"},[s._v("6")]),r("br"),r("span",{staticClass:"line-number"},[s._v("7")]),r("br"),r("span",{staticClass:"line-number"},[s._v("8")]),r("br"),r("span",{staticClass:"line-number"},[s._v("9")]),r("br"),r("span",{staticClass:"line-number"},[s._v("10")]),r("br"),r("span",{staticClass:"line-number"},[s._v("11")]),r("br"),r("span",{staticClass:"line-number"},[s._v("12")]),r("br"),r("span",{staticClass:"line-number"},[s._v("13")]),r("br"),r("span",{staticClass:"line-number"},[s._v("14")]),r("br")])]),r("h4",{attrs:{id:"已弃用的方法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#已弃用的方法"}},[s._v("#")]),s._v(" 已弃用的方法")]),s._v(" "),r("p",[s._v("根据迁移指南，以下方法已被弃用或重构：")]),s._v(" "),r("ul",[r("li",[s._v("merge")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("import { merge } from 'rxjs/operators';\na$.pipe(merge(b$, c$));\n// becomes\nimport { merge } from 'rxjs';\nmerge(a$, b$, c$);\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br")])]),r("ul",[r("li",[s._v("concat")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("import { concat } from 'rxjs/operators';\na$.pipe(concat(b$, c$));\n// becomes\nimport { concat } from 'rxjs';\nconcat(a$, b$, c$);\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br")])]),r("ul",[r("li",[s._v("combineLatest")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("import { combineLatest } from 'rxjs/operators';\na$.pipe(combineLatest(b$, c$));\n// becomes\nimport { combineLatest } from 'rxjs';\ncombineLatest(a$, b$, c$);\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br")])]),r("ul",[r("li",[s._v("race")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("import { race } from 'rxjs/operators';\na$.pipe(race(b$, c$));\n// becomes\nimport { race } from 'rxjs';\nrace(a$, b$, c$);\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br")])]),r("ul",[r("li",[s._v("zip")])]),s._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[s._v("import { zip } from 'rxjs/operators';\na$.pipe(zip(b$, c$));\n// becomes\nimport { zip } from 'rxjs';\nzip(a$, b$, c$);\n")])]),s._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[s._v("1")]),r("br"),r("span",{staticClass:"line-number"},[s._v("2")]),r("br"),r("span",{staticClass:"line-number"},[s._v("3")]),r("br"),r("span",{staticClass:"line-number"},[s._v("4")]),r("br"),r("span",{staticClass:"line-number"},[s._v("5")]),r("br")])]),r("h3",{attrs:{id:"总结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),r("p",[s._v("RxJS 6带来了一些重大改变，但是通过添加rxjs-compat软件包可以缓解这一问题，该软件包允许您在保持v5代码运行的同时逐渐迁移。对于Typescript用户，其他中包括大多数Angular开发人员，tslint提供了大量的自动重构功能，使转换变得更加简单。")]),s._v(" "),r("p",[s._v("任何升级与代码修改都会引入一些bug到代码库中。因此请务必测试您的功能以确保您的终端用户最终接受到相同的质量体验。")]),s._v(" "),r("blockquote",[r("p",[s._v("个人备注，现在网上大部分教程还是rxjs5的，rxjs6变化还是蛮大的，学习时候要留意区别。")])])])}),[],!1,null,null,null);a.default=n.exports}}]);