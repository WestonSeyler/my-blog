(window.webpackJsonp=window.webpackJsonp||[]).push([[156],{595:function(s,t,n){"use strict";n.r(t);var a=n(30),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h4",{attrs:{id:"容器网络调试工具-netshoot"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#容器网络调试工具-netshoot"}},[s._v("#")]),s._v(" 容器网络调试工具 netshoot")]),s._v(" "),n("p",[s._v("网络问题是我们使用容器技术时候经常碰到的问题，容器明明启动成功了就是ping不通，为了使容器尽量精简，有时并没有top,ps,netstat等网络命令，\n有一个方法是再启动一个包含很多工具命令的容器连接到出问题的容器同一网络进行调试，"),n("a",{attrs:{href:"https://github.com/nicolaka/netshoot",target:"_blank",rel:"noopener noreferrer"}},[s._v("netshoot"),n("OutboundLink")],1),s._v("就是这样的工具")]),s._v(" "),n("p",[s._v("源码其实非常简单,可以把他想象成一个调试外挂，哪个容器出问题了，就把他挂到同一网络。")]),s._v(" "),n("div",{staticClass:"language-dockerfile line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[n("code",[n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" debian:stable-slim "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" fetcher")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" build/fetch_binaries.sh /tmp/fetch_binaries.sh")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" apt-get update && apt-get install -y "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n  curl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n  wget")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" /tmp/fetch_binaries.sh")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" alpine:3.13")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" set -ex "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    && echo "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nl.alpinelinux.org/alpine/edge/main"')]),s._v(" >> /etc/apk/repositories "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    && echo "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nl.alpinelinux.org/alpine/edge/testing"')]),s._v(" >> /etc/apk/repositories "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    && echo "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nl.alpinelinux.org/alpine/edge/community"')]),s._v(" >> /etc/apk/repositories "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    && apk update "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    && apk upgrade "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    && apk add --no-cache "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    apache2-utils "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    bash "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    bind-tools "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    bird "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    bridge-utils "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    busybox-extras "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    conntrack-tools "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    curl "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    dhcping "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    drill "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    ethtool "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    fping "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    iftop "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    iperf "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    iproute2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    ipset "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("\\")]),s._v("\n    iptables \\ ")]),s._v("\n    iptraf-ng \\\n    iputils \\\n    ipvsadm \\\n    jq \\\n    libc6-compat \\\n    liboping \\\n    mtr \\\n    net-snmp-tools \\\n    netcat-openbsd \\\n    nftables \\\n    ngrep \\\n    nmap \\\n    nmap-nping \\\n    openssl \\\n    py3-pip \\\n    py3-setuptools \\\n    scapy \\\n    socat \\\n    speedtest-cli \\\n    strace \\\n    tcpdump \\\n    tcptraceroute \\\n    tshark \\\n    util-linux \\\n    vim \\ \n    git \\\n    zsh \\\n    websocat\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Installing httpie ( https://httpie.io/docs#installation)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" pip3 install --upgrade httpie")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Installing ctop - top-like container monitor")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token options"}},[n("span",{pre:!0,attrs:{class:"token property"}},[s._v("--from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("fetcher")])]),s._v(" /tmp/ctop /usr/local/bin/ctop")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Installing calicoctl")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token options"}},[n("span",{pre:!0,attrs:{class:"token property"}},[s._v("--from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("fetcher")])]),s._v(" /tmp/calicoctl /usr/local/bin/calicoctl")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Installing termshark")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token options"}},[n("span",{pre:!0,attrs:{class:"token property"}},[s._v("--from")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("fetcher")])]),s._v(" /tmp/termshark /usr/local/bin/termshark")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Setting User and Home")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /root")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" HOSTNAME netshoot")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ZSH Themes")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | zsh || true")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" git clone https://github.com/zsh-users/zsh-autosuggestions "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ZSH_CUSTOM:-~/.oh-my-zsh/custom}")]),s._v("/plugins/zsh-autosuggestions")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" git clone --depth=1 https://github.com/romkatv/powerlevel10k.git "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}")]),s._v("/themes/powerlevel10k")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" zshrc .zshrc")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" motd motd")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Fix permissions for OpenShift")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" chmod -R g=u /root")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Running ZSH")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token instruction"}},[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zsh"')]),s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br")])]),n("h4",{attrs:{id:"容器网络基础"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#容器网络基础"}},[s._v("#")]),s._v(" 容器网络基础")]),s._v(" "),n("blockquote",[n("p",[s._v("Docker")])]),s._v(" "),n("p",[s._v("bridge 模式是 Docker 默认的网络设置，此模式会为每一个容器分配 Network Namespace、设置 IP 等，并将一个主机上的 Docker 容器连接到一个虚拟网桥上。\n当 Docker server 启动时，会在主机上创建一个名为 docker0 的虚拟网桥，此主机上启动的 Docker 容器会连接到这个虚拟网桥上。虚拟网桥的工作方式和物理交换机类似，这样主机上的所有容器就通过交换机连在了一个二层网络中。\n接下来就要为容器分配 IP 了，Docker 会从 RFC1918 所定义的私有 IP 网段中，选择一个和宿主机不同的IP地址和子网分配给 docker0，连接到 docker0 的容器就从这个子网中选择一个未占用的 IP 使用。\n如一般 Docker 会使用 172.17.0.0/16 这个网段，并将 172.17.42.1/16 分配给 docker0 网桥（在主机上使用 "),n("code",[s._v("ifconfig")]),s._v(" 命令是可以看到 docker0 的，可以认为它是网桥的管理接口，在宿主机上作为一块虚拟网卡使用）")]),s._v(" "),n("blockquote",[n("p",[s._v("Kubernetes")])]),s._v(" "),n("p",[s._v("Kubernetes也使用Network Namespace概念。\nKubernetes为每个pod创建一个Network Namespace，其中该pod中的所有容器共享相同的网络名称空间(IP, tcp sockets等)。\n这是Docker容器和Kubernetes之间的一个关键区别。")]),s._v(" "),n("h4",{attrs:{id:"举例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#举例"}},[s._v("#")]),s._v(" 举例")]),s._v(" "),n("p",[s._v("这个例子来自docker官网 "),n("code",[s._v("https://docs.docker.com/get-started/07_multi_container/")])]),s._v(" "),n("p",[s._v("下面的命令，创建了名称为todo-app的网络，起了个mysql容器，这个容器在网络中的名称是mysql，由--network-alias指定")]),s._v(" "),n("div",{staticClass:"language-shell script line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker network create todo-app\ndocker run -d "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     --network todo-app --network-alias mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     -v todo-mysql-data:/var/lib/mysql "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("secret "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     -e "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_DATABASE")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("todos "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n     mysql:5.7\ndocker "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("mysql-container-id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mysql -u root -p\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("下面我们启动netshoot容器并加入同一网络，进入容器，使用dig命令来通过主机名查看IP地主")]),s._v(" "),n("div",{staticClass:"language-shell script line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("docker run -it --network todo-app nicolaka/netshoot\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dig")]),s._v(" mysql\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("返回内容类似")]),s._v(" "),n("div",{staticClass:"language-shell script line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" DiG "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.14")]),s._v(".1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" mysql\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" global options: +cmd\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" Got answer:\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("HEADER"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),s._v(" opcode: QUERY, status: NOERROR, id: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("32162")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" flags: qr rd ra"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" QUERY: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", ANSWER: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(", AUTHORITY: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", ADDITIONAL: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" QUESTION SECTION:\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("mysql.\t\t\t\tIN\tA\n\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" ANSWER SECTION:\n mysql.\t\t\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("600")]),s._v("\tIN\tA\t"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.23")]),s._v(".0.2\n\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" Query time: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" msec\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" SERVER: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.11"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#53(127.0.0.11)")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" WHEN: Tue Oct 01 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":47:24 UTC "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("\n "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" MSG SIZE  rcvd: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("还有种更简单的方式\n"),n("code",[s._v("docker run -it --net container:<container_name> nicolaka/netshoot")])]),s._v(" "),n("p",[s._v("如果要排查宿主机的网络问题\n"),n("code",[s._v("docker run -it --net host nicolaka/netshoot")])]),s._v(" "),n("h2",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),n("p",[s._v("https://docs.docker.com/get-started/07_multi_container/")]),s._v(" "),n("p",[s._v("https://docs.docker.com/engine/reference/commandline/network_create/#bridge-driver-options")]),s._v(" "),n("p",[s._v("https://www.huaweicloud.com/articles/5bb8f4efe7aaca9d4332750d73876db8.html")])])}),[],!1,null,null,null);t.default=e.exports}}]);