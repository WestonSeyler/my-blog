(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{574:function(s,n,t){"use strict";t.r(n);var e=t(30),a=Object(e.a)({},(function(){var s=this,n=s.$createElement,t=s._self._c||n;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[s._v("多谢此文：https://blog.eriksen.com.br/en/docker-image-multi-version-php-development")]),s._v(" "),t("p",[s._v("最近一个新的后台API项目需要运行在PHP5.3环境中，而无论是本地还是测试服务器都安装的是PHP7.x\nPHP5.3官方已经不维护了，通过源码安装配置也很麻烦，我又不想污染现有的环境。\n所以想到了docker\n我觉得docker适合以下情况：")]),s._v(" "),t("ol",[t("li",[s._v("运行特定的开发环境，比如要运行两个项目。一个要求PHP5.6，一个PHP7.0。不想来回切换。")]),s._v(" "),t("li",[s._v("喜欢尝鲜，折腾，docker有很强的隔离性。在docker里搞坏也不会破坏本地，用到的时候docker run 启动镜像和容器，不想用了docker rm 删掉即可。")])]),s._v(" "),t("p",[s._v("新项目是基于 ThinkPHP3.2\n想通过docker跑起来，可以按如下步骤：")]),s._v(" "),t("ol",[t("li",[s._v("安装 docker，略\n记得一定要切换为国内源，不然速度巨慢，还容易报错，推荐免费的https://www.daocloud.io/mirror#accelerator-doc")]),s._v(" "),t("li",[s._v("下载镜像\n"),t("code",[s._v("docker pull eriksencosta/php-dev")])]),s._v(" "),t("li",[s._v("项目目录是已经存在的\n路径是 "),t("code",[s._v("D:/projects/live-ranking-api")])]),s._v(" "),t("li",[s._v("运行容器  其中参数：-p 端口映射  -v 挂载目录，冒号前是宿主机目录，后面的是容器内目录\n-t -i 参数 表示已交互方式运行容器，运行成功后会执行 /bin/bash  就是进去终端\n"),t("code",[s._v('docker run -t -i -p 8088:80 -v D:/projects/live-ranking-api:/var/www -d "eriksencosta/php-dev:latest" /bin/bash')])])]),s._v(" "),t("blockquote",[t("p",[t("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-55b0e9da91db9375.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})])]),s._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[s._v("打开浏览器输入 "),t("code",[s._v("localhost:8088")]),s._v(" 正常的话项目已经成功跑起来了")]),s._v(" "),t("li",[s._v("切换PHP版本，在容器内的终端内输入 "),t("code",[s._v("phpenv命令")]),s._v(" 列出当前可选择的PHP版本")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# phpenv versions")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.3")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.3")]),s._v(".29\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.4")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.4")]),s._v(".35\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.5")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.5")]),s._v(".19\n  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.6")]),s._v("\n* "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.6")]),s._v(".3 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("set by /opt/phpenv/version"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("执行 phpenv global 5.4")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# phpenv global 5.4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# php -v")]),s._v("\nPHP "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.4")]),s._v(".35 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cli"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("built: Dec "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2014")]),s._v(" 00:35:12"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nCopyright "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1997")]),s._v("-2014 The PHP Group\nZend Engine v2.4.0, Copyright "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1998")]),s._v("-2014 Zend Technologies\n    with Zend OPcache v7.0.3, Copyright "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1999")]),s._v("-2014, by Zend Technologies\n    with Xdebug v2.2.6, Copyright "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2002")]),s._v("-2014, by Derick Rethans\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("启动nginx")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# webserver start")]),s._v("\nStarting PHP-FPM "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PHP version "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" server.\nStarting Nginx server.\nDone.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考：")]),s._v(" "),t("ul",[t("li",[s._v("https://hub.docker.com/r/eriksencosta/php-dev/")]),s._v(" "),t("li",[s._v("https://github.com/eriksencosta/silex-docker-example")])])])}),[],!1,null,null,null);n.default=a.exports}}]);