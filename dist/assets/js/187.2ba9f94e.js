(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{624:function(e,s,n){"use strict";n.r(s);var a=n(30),t=Object(a.a)({},(function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h4",{attrs:{id:"jenkins-run-in-docker-问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-run-in-docker-问题"}},[e._v("#")]),e._v(" Jenkins run in Docker 问题")]),e._v(" "),n("ol",[n("li",[e._v("通过docker 跑的 Jenkins 安装插件失败 "),n("code",[e._v("Also: java.lang.Throwable: HttpInput failure")]),e._v("\n可能是Docker配置的网络问题\n第二天，又自己好了。。")])]),e._v(" "),n("p",[n("a",{attrs:{href:"https://issues.jenkins-ci.org/browse/JENKINS-58073?page=com.atlassian.jira.plugin.system.issuetabpanels%3Aall-tabpanel",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://issues.jenkins-ci.org/browse/JENKINS-58073?page=com.atlassian.jira.plugin.system.issuetabpanels%3Aall-tabpanel"),n("OutboundLink")],1)]),e._v(" "),n("h4",{attrs:{id:"插件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#插件"}},[e._v("#")]),e._v(" 插件")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://wiki.jenkins.io/display/JENKINS/Publish+Over+SSH+Plugin",target:"_blank",rel:"noopener noreferrer"}},[e._v("Publish Over SSH"),n("OutboundLink")],1)]),e._v(" "),n("ul",[n("li",[n("code",[e._v("Remote directory")]),e._v(" 参数问题")])]),e._v(" "),n("p",[e._v("Publish Over SSH是款很常用的插件，一般用于通过SSH将构建后的文件传到远程主机上。\n其中的"),n("code",[e._v("Remote directory")]),e._v("选项是相对的登录后的路径。而不是远程主机的全路径\n比如你登录主机后的pwd是"),n("code",[e._v("/home/mafei/")]),e._v("。即便你在Jenkins配置中填的"),n("code",[e._v("Remote directory")]),e._v("是"),n("code",[e._v("/var/www")]),e._v("。\n执行后的实际路径是 "),n("code",[e._v("/home/mafei/var/www")])]),e._v(" "),n("ul",[n("li",[e._v("execCommand 是要在远程主机上执行的shell命令")])]),e._v(" "),n("p",[e._v("有两种方式：")]),e._v(" "),n("p",[e._v("第一种，在远程主机上放一个sh文件里面包含所有要在主机上执行的操作，比如"),n("code",[e._v("deploy.sh")]),e._v(" "),n("code",[e._v("execCommand: '''sh deploy.sh'''")])]),e._v(" "),n("p",[e._v("第二种，把具体命令都写execCommand里面\n下面的脚本有一定的通用性，首先将之前步骤构建的dist压缩，上传到远程服务器，然后在远程上执行下面的命令，先重命名老的dist，然后将新的压缩包解压")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("execCommand: '''\n# sh deploy.sh\n# 这里可以定义变量\n# DEST_PATH 项目的发布路径\nDEST_PATH=/var/www/web/\nTODAY=$(date +%Y%m%d-%H%M%S)\n\ncp -rf dist.gz $DEST_PATH\ncd $DEST_PATH\ntar -zcvf $TODAY-dist.gz dist\nrm -rf dist\ntar -xzvf dist.gz\n'''\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br")])]),n("ul",[n("li",[e._v("使用注意事项：")])]),e._v(" "),n("ol",[n("li",[e._v("Source files(要上传的文件) 和 Exec command(要在远程服务器执行的命令) 至少有一个必填的,\n如果 Source files 为空，什么也不会传")]),e._v(" "),n("li",[e._v("Source files, Remove prefix, Remote directory 和 Exec command  这几个参数，可以使用 Jenkins  的environment variables 和 build parameters.")])]),e._v(" "),n("h5",{attrs:{id:"extended-e-mail-notification"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#extended-e-mail-notification"}},[e._v("#")]),e._v(" Extended E-mail Notification")]),e._v(" "),n("p",[e._v("配置Gmail\n勾选 SSL，端口填写 465")]),e._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-5252e11e4087c7c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})])]),e._v(" "),n("p",[e._v("首次登陆 Google 会阻止，建议调低安全")]),e._v(" "),n("blockquote",[n("p",[n("img",{attrs:{src:"https://hexo-blog.pek3b.qingstor.com/upload_images/71414-c3f6ff50feddb0c8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240",alt:"image.png"}})])])])}),[],!1,null,null,null);s.default=t.exports}}]);